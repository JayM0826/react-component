<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/Select/index.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/daifee/react-component.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ChildContainer">ChildContainer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-classNames">classNames</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createInstance">createInstance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-config">config</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">ActionSheet</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ActionSheet">ActionSheet</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Button</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Button">Button</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Cell</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Cell">Cell</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CellBody">CellBody</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CellFooter">CellFooter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CellHeader">CellHeader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Cells">Cells</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CellTips">CellTips</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CellTitle">CellTitle</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Checkbox</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Checkbox">Checkbox</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">DatePicker</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/DatePicker/index.js~DatePicker.html">DatePicker</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Dialog</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Dialog">Dialog</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Fade</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Fade">Fade</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Icon</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-IconAttention">IconAttention</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-IconCheck">IconCheck</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-IconLoading">IconLoading</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">ListView</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ListView/index.js~ListView.html">ListView</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Mask</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Mask">Mask</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Notification</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Notification">Notification</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Page</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Page">Page</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Popup</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Popup">Popup</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">ScrollView</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ScrollView/index.js~ScrollView.html">ScrollView</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Select</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Select/index.js~Select.html">Select</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Switch</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Switch">Switch</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">TabBar</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TabBar">TabBar</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TabBarItem">TabBarItem</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">Toast</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Toast">Toast</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/Select/index.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import React, {
  Component,
  PropTypes
} from &apos;react&apos;;
import {classNames} from &apos;../utils&apos;;
import IScroll from &apos;xiscroll&apos;;
import &apos;./style&apos;;

const height = 34;
const maskStyle = {height: (height * 3 + &apos;px&apos;)};
const optionStyle = {
  height: (height + &apos;px&apos;),
  lineHeight: (height + &apos;px&apos;)
};

/**
 * Select UI
 * @param {object} props see static propTypes
 */
export default class Select extends Component {
  /**
   * props
   * @type {Object}
   * options: &#x9009;&#x9879;
   * selectedIndex: &#x9009;&#x4E2D;&#x9879;&#x7684;&#x7D22;&#x5F15;
   * onChange: &#x76D1;&#x542C; selectedIndex &#x6539;&#x53D8;&#xFF0C;&#x53C2;&#x6570;&#x662F; [selectedIndex]
   * iscrollOptions: &#x914D;&#x7F6E; iscroll
   */
  static propTypes = {
    options: PropTypes.array.isRequired,
    selectedIndex: PropTypes.number,
    onChange: PropTypes.func,
    iscrollOptions: PropTypes.object,
    className: PropTypes.string,
    style: PropTypes.object
  };

  static defaultProps = {
    selectedIndex: 0
  };

  // iscroll &#x5B9E;&#x4F8B;
  iscroller = null;


  render() {
    let {options, className, style, ...others} = this.props;

    className = classNames(&apos;select&apos;, {_user: className});
    style = {...style, height: (height * 7 + &apos;px&apos;)};
    // fill
    options = [&apos;&apos;, &apos;&apos;, &apos;&apos;].concat(options).concat([&apos;&apos;, &apos;&apos;, &apos;&apos;]);

    return (
      &lt;div ref=&apos;wrapper&apos; className={className} style={style} {...others}&gt;
        &lt;ul className={classNames(&apos;select-options&apos;)}&gt;
          {options.map((option, index) =&gt; {
            let name = typeof option === &apos;object&apos; ? option.name : option;
            let key = index + &apos;@-@&apos; + name;

            return (&lt;li key={key} style={optionStyle}&gt;{name}&lt;/li&gt;);
          })}
        &lt;/ul&gt;

        &lt;div style={maskStyle} className={classNames(&apos;select-mask-top&apos;)}&gt;&lt;/div&gt;
        &lt;div style={maskStyle} className={classNames(&apos;select-mask-bottom&apos;)}&gt;&lt;/div&gt;
      &lt;/div&gt;
    );
  }

  componentDidMount() {
    let {
      iscrollOptions,
      onChange
    } = this.props;
    let {wrapper} = this.refs;
    // fuck a bug
    setTimeout(() =&gt; {
      this.iscroller = new IScroll(wrapper, {
        probeType: 2,  // &#x9ED8;&#x8BA4;&#x503C;
        ...iscrollOptions
      });

      this.iscroller.on(&apos;scrollEnd&apos;, () =&gt; {
        let index = Math.abs(this.iscroller.y / height);
        onChange &amp;&amp; onChange(index);
      });

      // &#x901A;&#x8FC7; hookNewY &#x4FEE;&#x6539;&#x6EDA;&#x52A8;&#x4F4D;&#x7F6E;
      this.iscroller.hookNewY = (newY) =&gt; {
        // Math.ceil(-8.74) = -8
        // &#x6240;&#x4EE5;&#x5DF2;&#x7ECF; -1 &#x4E86;
        let index = Math.ceil(newY / height);

        if (Math.abs(this.iscroller.distY) &gt; (height / 2)) {
          if (this.iscroller.directionY === 1) {
            index -= 1;
          }
        }

        newY = index * height;

        return newY;
      };

      this.resetPosition();

      // &#x963B;&#x6B62;&#x9ED8;&#x8BA4;&#x4E8B;&#x4EF6;
      wrapper.addEventListener(&apos;touchmove&apos;, (e) =&gt; {
        e.preventDefault();
      });
    }, 0);
  }

  shouldComponentUpdate(nextProps) {
    return true;
  }

  componentDidUpdate() {
    this.iscroller.refresh();
    this.resetPosition();
  }

  resetPosition() {
    let {selectedIndex} = this.props;
    // &#x5B9A;&#x4F4D;&#x5230;&#x6307;&#x5B9A;&#x7684; selectIndex
    this.iscroller.scrollTo(0, (-selectedIndex * height));
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.7)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
